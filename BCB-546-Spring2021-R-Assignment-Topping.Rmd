---
title: "R-Assignment-BCB546-Spring2021-Topping"
author: "Nick Topping"
date: "3/17/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Assignment

To start, create a repository on GitHub.
My repository is named R-Assignment-BCB546-Spring2021-Topping.
To load the working repository into R Studio:

1. Clone the repository to your clipboard
2. Open R Studio and click File, New Project, Version Control, Git
3. Paste the repository URL, fill in the directory name and click Create Project

Then, load any R packages needed for this assignment. They are:

``` {r}
install.packages("tidyverse")
library(Tidyverse)
```

Next, open both data files, `fang_et_al_genotypes` and `snp_position.txt`.
Both of these files were pulled from my computer where I already had them saved
``` {r}
fang_et_al_genotypes <- read.table("https://raw.githubusercontent.com/EEOB-BioData/BCB546-Spring2021/master/assignments/UNIX_Assignment/fang_et_al_genotypes.txt", header = TRUE,)
snp_position <- read.table("https://raw.githubusercontent.com/EEOB-BioData/BCB546-Spring2021/master/assignments/UNIX_Assignment/snp_position.txt", header = TRUE, sep = "\t")
```
To quickly look at the data files, double click on them in the Environment. This will show the data in a .txt file that you can see.

Note: You can also use the function `view(fang_et_al_genotypes)` will also show the data, but it isn't working in my markdown file for some reason...

##### Below are a few codes you can use to inspect the data

`object.size()` shows the file size of the data frame

`nrow()` shows the number of rows

`ncol()` shows the number of columns

`dim()` shows the dimensions of the data frame by row and column

`head()` show first 6 rows

`tail()` shows last 6 rows

`str()` shows the structure of the data frame: the name, type and preview of data in each column

`names()` shows the names attributes for the data frame, which are also the column names

the function `colnames()` also will show the column names

`sapply(dataframe, class)` shows the class of each column of data

## fang_et_al_genotypes

``` {r}
object.size(fang_et_al_genotypes)
```

``` {r}
nrow(fang_et_al_genotypes)
```

``` {r}
ncol(fang_et_al_genotypes)
```

``` {r}
dim(fang_et_al_genotypes)
```

Note: The output for functions `head()` `tail()` `str()` `names()` and `sapply(dataframe, class)` are not included in this markdown file for this data table as these outputs are very long and clutter the console

## snp_position

``` {r}
object.size(snp_position)
```

``` {r}
nrow(snp_position)
```

``` {r}
ncol(snp_position)
```

``` {r}
dim(snp_position)
```

``` {r}
str(snp_position)
```

``` {r}
names(snp_position)
```

``` {r}
sapply(snp_position, class)
```

For this data table, only `head()` and `tails()` were left out of the snp_position analyses

##Creating New Data Filess

Create two new data frames sorted by the ID's of both species from fang_et_al_genotypes with the following code:

``` {r}
Maize_IDs <- fang_et_al_genotypes[which(fang_et_al_genotypes$Group == "ZMMIL" | fang_et_al_genotypes$Group == "ZMMLR" | fang_et_al_genotypes$Group == "ZMMMR"),]
Teosinte_IDs <- fang_et_al_genotypes[which(fang_et_al_genotypes$Group == "ZMPBA" | fang_et_al_genotypes$Group == "ZMPIL" | fang_et_al_genotypes$Group == "ZMPJA"),]
```

Then pull columns 1, 3 and 4 from the file snp_position and combine them into one

``` {r}
SNP_Chrom_Pos <- snp_position[,c(1,3,4)]
```

The next step is to combine the data files so that the first column is "SNP_ID", second is "Chromosome", third is "Position", and the rest are genotype data. In order to do this, `Maize_IDs` and `Teosinte_IDs` must be transposed, THEN combined

``` {r}
Maize_IDs_Transposed <- as.data.frame(t(Maize_IDs[,-1]))
colnames(Maize_IDs_Transposed) <- Maize_IDs$Sample_ID
Teosinte_IDs_Transposed <- as.data.frame(t(Teosinte_IDs[,-1]))
colnames(Teosinte_IDs_Transposed) <- Teosinte_IDs$Sample_ID
```

``` {r}
Maize_IDs_Transposed <- cbind(SNP_ID = row.names(Maize_IDs_Transposed), Maize_IDs_Transposed)
Teosinte_IDs_Transposed <- cbind(SNP_ID = row.names(Teosinte_IDs_Transposed), Teosinte_IDs_Transposed)
```

To combine the transposed data frames with the first file `SNP_Chrom_Pos` merge the files by SNP_ID

Combine the transposed data frames with the previous file `SNP_Chrom_Pos` followed by either maize or teosinte #note that the rows should stay in the same order

``` {r}
Maize_Chromosomes <- merge(SNP_Chrom_Pos,Maize_IDs_Transposed, by = "SNP_ID")
Teosinte_Chromosomes <- merge(SNP_Chrom_Pos,Teosinte_IDs_Transposed, by = "SNP_ID")
```

Sort both new files by position with the `order()` function

``` {r}
Maize_Chromosomes_Ascending <- Maize_Chromosomes[order(Maize_Chromosomes$Position), ]
Teosinte_Chromosomes_Ascending <- Teosinte_Chromosomes[order(Teosinte_Chromosomes$Position), ]
Maize_Chromosomes_Descending <- Maize_Chromosomes[order(Maize_Chromosomes$Position, decreasing = T), ]
Teosinte_Chromosomes_Descending <- Teosinte_Chromosomes[order(Teosinte_Chromosomes$Position, decreasing = T), ]
```

``` {r}
Maize_Ascending_Chromosome_1 <- Maize_Chromosomes_Ascending %>% filter(Chromosome == 1)
```



